<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kimberly's Creative Sprint: A 90-day practice: daily videos, essays, livestreams, and experiments.</title>
    <meta name="description" content="Join Kimberly's 90-day creative challenge. Outrunning perfectionism one creative entry at a time.">
    <meta name="theme-color" content="#341046">
    <meta name="robots" content="index, follow">

    <link rel="canonical" href="https://knf.kim/90in90">
    <meta property="og:title" content="Kimberly's Creative Sprint - 90 Days of Ideas">
    <meta property="og:description" content="Join Kimberly's 90-day creative challenge. Outrunning perfectionism one creative entry at a time.">
    <meta property="og:image" content="https://knfoster13.github.io/HQ/KCSMAGENTABIG.png">
    <meta property="og:image:alt" content="Kimberly's 90-day Creative Sprint">
    <meta property="og:url" content="https://knf.kim/90in90">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Kimberly's Creative Sprint">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Kimberly's Creative Sprint - 90 Days of Ideas">
    <meta name="twitter:description" content="Join Kimberly's 90-day creative challenge. Outrunning perfectionism one creative entry at a time.">
    <meta name="twitter:image" content="https://knfoster13.github.io/HQ/KCSMAGENTABIG.png">
    <meta name="twitter:creator" content="@kimberlynfoster">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Kimberly's Creative Sprint",
      "description": "90 Days of Ideas",
      "url": "https://knf.kim/90in90",
      "publisher": {
        "@type": "Person",
        "name": "Kimberly Nicole Foster"
      }
    }
    </script>
    <script type="application/ld+json" id="itemListSchema"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@400;500;600;700&family=DM+Serif+Display&family=Special+Elite&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root {
        --center-plum: #973f8e;
        --mid-violet: #602172;
        --deep-purple: #341046;
        --edge-dark: #200028;
        --accent: #d3c5e9;
        --accent-light: #efeaf7;
        --text-primary: #fdfbff;
        --text-secondary: #e1d9ed;
        --text-muted: #b8aec7;
        --surface: rgba(45, 24, 63, 0.5);
        --surface-hover: rgba(55, 34, 73, 0.7);
        --border-color: rgba(211, 197, 233, 0.2);
        --border-color-hover: rgba(211, 197, 233, 0.4);
        --cta: #d3c5e9;
        --cta-hover: #efeaf7;
        --tag-free: #a7f3d0;
        --tag-paid: #fef08a;
        --heart: #f472b6;
        --success: #6ee7b7;
        --warning: #facc15;
        --error: #f87171;
        --cursor-x: 50vw;
        --cursor-y: 50vh;
      }

      /* Base & Typography */
      html { scroll-behavior: smooth; }
      body {
        font-family: 'Inter', sans-serif;
        color: var(--text-primary);
        background: radial-gradient(circle at center, var(--center-plum) 0%, var(--mid-violet) 40%, var(--deep-purple) 75%, var(--edge-dark) 100%);
        background-attachment: fixed;
        min-height: 100vh;
        line-height: 1.75;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        hyphens: auto;
      }
      
      body::before {
          content: '';
          position: fixed;
          top: 0; left: 0;
          width: 100%; height: 100%;
          background: radial-gradient(
            circle 400px at var(--cursor-x) var(--cursor-y),
            rgba(211, 197, 233, 0.04),
            transparent 80%
          );
          pointer-events: none;
          z-index: -1;
      }

      h1, h2, h3, h4, .brand-font {
        font-family: 'Source Serif Pro', serif;
        line-height: 1.2;
        color: var(--accent-light);
        text-wrap: balance;
      }

      h1 { font-size: 2.75rem !important; letter-spacing: -0.015em; color: var(--accent); }
      h2 { font-size: clamp(1.5rem, 4vw, 2rem); font-weight: 600; color: var(--accent); }
      h3 { font-size: clamp(1.1rem, 1rem + 0.5vw, 1.2rem); letter-spacing: -0.01em; font-weight: 600; }
      p { max-width: 65ch; color: var(--text-secondary); }
      
      em, i { font-style: italic; }

      .text-gradient {
        background: linear-gradient(to right, var(--accent), var(--accent-light));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }
      .monospace {
        font-family: 'Special Elite', monospace;
      }

       /* Accessibility */
      .skip-to-content { 
        position: absolute; 
        left: 0; 
        background: var(--accent); 
        color: var(--edge-dark); 
        padding: 8px 12px; 
        text-decoration: none; 
        z-index: 10000;
        transform: translateY(-120%);
        transition: transform 0.3s ease;
        border-radius: 0 0 0.375rem 0;
      }
      .skip-to-content:focus { 
        transform: translateY(0);
      }

      /* Components */
       .frosted-header {
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        background: rgba(32, 0, 40, 0.65);
        border-bottom: 1px solid var(--border-color);
      }
      .card {
        background: var(--surface);
        border: 1px solid var(--border-color);
        border-radius: 0.5rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease, opacity 0.5s ease;
        position: relative;
      }
       .fade-in-section, main .card {
        opacity: 0;
        transform: translateY(20px);
      }
      .fade-in-section.is-visible, main .card.is-visible {
        opacity: 1;
        transform: translateY(0);
      }
      .card:hover {
        transform: translateY(-4px) rotate(-0.5deg);
        border-color: var(--accent);
        background: var(--surface-hover);
        box-shadow: 0 12px 30px rgba(0,0,0, 0.3);
      }

      .btn {
        font-weight: 600; padding: 0.625rem 1.5rem; border-radius: 0.375rem;
        transition: all 0.2s ease; border: 1px solid var(--border-color); cursor: pointer;
        display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
      }
      .btn-primary {
        background: var(--accent);
        color: var(--edge-dark);
        border-color: var(--accent);
      }
      .btn-primary:hover:not(:disabled) { 
        background: var(--accent-light);
        border-color: var(--accent-light);
        transform: translateY(-1px);
        box-shadow: 0 0 10px rgba(211, 197, 233, 0.25);
      }
      .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
      
      .btn-secondary { 
        background: transparent; 
        color: var(--text-secondary);
      }
      .btn-secondary:hover:not(:disabled) { 
        background: rgba(211, 197, 233, 0.1);
        border-color: var(--accent);
      }
      
      .form-input {
        background: rgba(0, 0, 0, 0.2); border: 1px solid var(--border-color);
        color: var(--text-primary); padding: 0.75rem 1rem; border-radius: 0.375rem;
        width: 100%; transition: all 0.2s ease;
      }
      .form-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(211, 197, 233, 0.1); }
      .tag {
        font-size: 0.75rem; font-weight: 700; padding: 0.5rem 1rem;
        text-transform: uppercase; letter-spacing: 0.05em;
        border-radius: 9999px; line-height: 1.2;
      }
      .tag-free { 
        background: rgba(167, 243, 208, 0.1); color: var(--tag-free); 
        border: 1px solid rgba(167, 243, 208, 0.2);
      }
      .tag-paid { 
        background: rgba(254, 240, 138, 0.1); color: var(--tag-paid); 
        border: 1px solid rgba(254, 240, 138, 0.2);
      }
      
      .heart-btn { transition: all 0.2s ease; cursor: pointer; }
      .heart-btn:hover svg { transform: scale(1.1); }
      .heart-btn.hearted svg { fill: var(--heart); stroke: var(--heart); animation: heartPulse 0.3s ease; }
      @keyframes heartPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
      
      .filter-btn {
            padding: 0.5rem 1rem; background: transparent;
            border: 1px solid var(--border-color); color: var(--text-secondary);
            border-radius: 0.375rem; cursor: pointer; transition: all 0.2s ease;
        }
        .filter-btn:hover { background: rgba(211, 197, 233, 0.1); }
        .filter-btn.active {
            background: rgba(211, 197, 233, 0.15);
            color: var(--accent-light); border-color: var(--accent);
        }

      ::-webkit-scrollbar { width: 8px; }
      ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 4px; }
      
       .loading-spinner { border: 2px solid rgba(211, 197, 233, 0.2); border-radius: 50%; border-top: 2px solid var(--accent); width: 20px; height: 20px; animation: spin 1s linear infinite; }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
      
      .toast {
        position: fixed; bottom: 2rem; left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: var(--surface); color: var(--text-primary); padding: 1rem 1.5rem;
        border-radius: 0.5rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        opacity: 0; transition: transform 0.3s, opacity 0.3s; z-index: 1000;
        display: flex; align-items: center; gap: 0.75rem;
        border: 1px solid var(--border-color);
      }
      .toast.show { transform: translateY(0); opacity: 1; }

      .welcome-modal p:first-of-type::first-letter {
        font-size: 3.5rem;
        float: left;
        line-height: 0.8;
        margin: 0.1em 0.1em 0 0;
        font-family: 'Source Serif Pro';
        color: var(--accent);
      }

      .marginalia {
        font-size: 0.9em;
        background: rgba(0,0,0,0.1);
        border-top: 1px solid var(--border-color);
        padding: 0.75rem 1rem;
        margin: 1rem -1.25rem -1.25rem -1.25rem;
        display: none;
      }
      .marginalia.show { display: block; }
      .marginalia-toggle {
        font-size: 0.8em;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-weight: 600;
        color: var(--text-muted);
      }
      
      #toc-view { display: none; }
      #toc-view.active { display: block; }
      #content-feed.hidden { display: none; }

      .day-dot {
        width: 0.5rem;
        height: 0.5rem;
        border-radius: 50%;
        transition: transform 0.2s ease, background-color 0.2s ease;
      }
      .day-dot:hover {
          transform: scale(1.5);
          background-color: var(--accent-light);
      }
      .day-dot.current {
          background-color: var(--cta);
          transform: scale(1.75);
          box-shadow: 0 0 8px var(--cta);
      }
    </style>
</head>
<body class="bg-edge-dark">
    <a href="#content-feed" class="skip-to-content">Skip to content</a>

    <header class="sticky top-0 z-50 frosted-header" role="banner">
        <nav class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
            <a href="#" class="header-logo flex items-center gap-3" aria-label="Creative Sprint Home">
                <img src="https://knfoster13.github.io/HQ/90in90-1-CROPPED.png" alt="Logo" class="h-9 w-auto">
                <span class="hidden sm:inline font-semibold text-lg brand-font text-white">Kimberly’s Creative Sprint</span>
            </a>

             <div class="hidden md:flex items-center gap-6 text-center">
                <div class="flex flex-col"><span id="header-day" class="text-base font-bold">1</span><span class="text-xs uppercase tracking-wider text-muted">Day</span></div>
                <div class="h-6 w-px bg-white/10"></div>
                <div class="flex flex-col"><span id="header-entries" class="text-base font-bold">0</span><span class="text-xs uppercase tracking-wider text-muted">Entries</span></div>
                <div class="h-6 w-px bg-white/10"></div>
                <div class="flex flex-col"><span id="header-streak" class="text-base font-bold">0</span><span class="text-xs uppercase tracking-wider text-muted">Streak</span></div>
            </div>

            <div class="flex items-center gap-2">
                <button id="subscribe-btn" class="btn btn-primary" aria-label="Join the sprint">
                    <span class="hidden sm:inline">Join the Sprint</span>
                    <span class="sm:hidden">Join</span>
                </button>
            </div>
        </nav>
        <div id="header-progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="90" aria-valuenow="1" class="w-full h-1 bg-white/10">
            <div class="header-progress-fill h-full" style="width: 1%;"></div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8" role="main" id="main-content">
        <section class="text-center pt-8 pb-12 flex flex-col justify-center items-center" aria-labelledby="hero-title">
            <img src="https://knfoster13.github.io/HQ/KCSMAGENTABIG.png" alt="Kimberly's Creative Sprint" class="hero-image mx-auto w-full max-w-sm mb-4" fetchpriority="high" decoding="async" loading="eager">
            <h1 id="hero-title" class="max-w-xl mx-auto">A 90-Day Sprint Through Ideas, Images & Inquiry</h1>
            <p class="text-xl italic mt-2" style="color: var(--text-secondary);">
                <em>Think. Make. Share. Repeat.</em>
            </p>
        </section>
        
        <div class="my-16 text-center">
            <img src="https://knfoster13.github.io/HQ/90in90-1-CROPPED.png" alt="Decorative separator" class="mx-auto w-32 opacity-50"/>
        </div>

        <section id="sprint-details" class="fade-in-section max-w-4xl mx-auto text-center">
             <div id="chapter-markers" class="mb-10"></div>
             <div class="mb-6">
                <p id="weekly-theme" class="text-lg font-medium italic" style="color: var(--text-secondary);"></p>
            </div>
             <div class="mb-6 text-center">
                <strong id="challenge-dates" class="text-2xl font-medium block" style="color: var(--text-secondary);"></strong>
            </div>
             <div class="mt-6 flex flex-wrap gap-3 justify-center">
                <button id="show-welcome-btn" class="btn btn-secondary">What is this Sprint?</button>
                <button id="hero-subscribe-btn" class="btn btn-primary">Newsletter</button>
                <a href="sms-optin.html" class="btn btn-secondary">SMS Alerts 📱</a>
            </div>
            <div id="day-dots-container" class="flex gap-1.5 justify-center flex-wrap max-w-full py-2 px-4 mt-8"></div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-10 max-w-2xl mx-auto" role="region" aria-label="Challenge statistics">
                <div class="card p-4 text-center"><div class="text-2xl font-semibold text-accent-light" id="today-count" aria-live="polite">0</div><div class="text-sm text-muted">Today’s Entries</div></div>
                <div class="card p-4 text-center"><div class="text-2xl font-semibold text-accent-light" id="streak-count" aria-live="polite">0</div><div class="text-sm text-muted">Day Streak</div></div>
                <div class="card p-4 text-center"><div class="text-2xl font-semibold text-accent-light" id="free-count" aria-live="polite">0</div><div class="text-sm text-muted">Free Content</div></div>
                <div class="card p-4 text-center"><div class="text-2xl font-semibold text-accent-light" id="paid-count" aria-live="polite">0</div><div class="text-sm text-muted">Premium</div></div>
            </div>
        </section>
        
        <section id="admin-panel" class="hidden transition-all duration-500 card mt-12" aria-label="Admin panel">
            <div class="p-6">
                <h2 class="font-semibold mb-4 flex items-center gap-2 brand-font"><svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>Add or Edit Entry</h2>
                <form id="spark-form" class="space-y-4" novalidate>
                    <!-- Form fields unchanged except for footnotes -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div><label for="spark-title" class="block text-sm font-medium mb-1">Title *</label><input type="text" id="spark-title" class="form-input" required maxlength="200" aria-required="true"></div>
                        <div><label for="spark-type" class="block text-sm font-medium mb-1">Content Type *</label><select id="spark-type" class="form-input" aria-required="true"><option>Video</option><option>Podcast</option><option>Essay</option><option>Social Post</option><option>Newsletter</option><option>Tutorial</option><option>Other</option></select></div>
                    </div>
                    <div><label for="spark-description" class="block text-sm font-medium mb-1">Description *</label><textarea id="spark-description" class="form-input" rows="2" required maxlength="500" aria-required="true"></textarea></div>
                     <div><label for="spark-footnotes" class="block text-sm font-medium mb-1">Marginalia / Footnotes</label><textarea id="spark-footnotes" class="form-input" rows="3" placeholder="Add references, asides, or additional thoughts here..."></textarea></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div><label for="spark-link" class="block text-sm font-medium mb-1">Link *</label><input type="url" id="spark-link" class="form-input" required aria-required="true"></div>
                        <div><label for="spark-image" class="block text-sm font-medium mb-1">Image URL</label><input type="url" id="spark-image" class="form-input"></div>
                        <div><label for="spark-access" class="block text-sm font-medium mb-1">Access Level</label><select id="spark-access" class="form-input"><option>Free</option><option>Paid</option></select></div>
                    </div>
                    <div class="flex items-center gap-4 pt-2">
                        <button type="submit" id="publish-btn" class="btn btn-primary" disabled><span class="loading-spinner hidden"></span><span id="publish-btn-text">Publish Entry</span></button>
                        <button type="button" id="cancel-edit-btn" class="btn btn-secondary hidden">Cancel Edit</button>
                    </div>
                </form>
            </div>
        </section>
        
        <section class="mt-12" aria-label="Search and filter entries">
             <div class="card p-4">
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="relative md:col-span-1">
                        <input type="text" id="search-input" class="form-input pl-10" placeholder="Search entries..." aria-label="Search entries">
                        <svg class="w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                    <div class="flex items-center gap-2 justify-between md:col-span-2">
                        <div class="flex gap-2 flex-wrap" role="group" aria-label="Filter options">
                           <button class="filter-btn active" data-view="grid" id="view-toggle-grid">Grid View</button>
                           <button class="filter-btn" data-view="toc" id="view-toggle-toc">Table of Contents</button>
                        </div>
                        <select id="sort-select" class="form-input w-40" aria-label="Sort entries">
                            <option value="newest">Newest</option>
                            <option value="oldest">Oldest</option>
                            <option value="most-loved">❤️ Most Loved</option>
                        </select>
                    </div>
                </div>
            </div>
        </section>

        <section id="content-feed" class="mt-6" aria-label="Content feed" aria-busy="true" aria-live="polite">
            <div id="skeleton-loaders" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
                 <div class="skeleton-card"><div class="flex flex-col gap-4"><div class="h-40 skeleton-line rounded-lg"></div><div class="flex-1 space-y-2"><div class="skeleton-line w-3/4"></div><div class="skeleton-line w-1/2"></div><div class="skeleton-line w-full"></div></div></div></div>
                 <div class="skeleton-card"><div class="flex flex-col gap-4"><div class="h-40 skeleton-line rounded-lg"></div><div class="flex-1 space-y-2"><div class="skeleton-line w-3/4"></div><div class="skeleton-line w-1/2"></div><div class="skeleton-line w-full"></div></div></div></div>
                 <div class="skeleton-card"><div class="flex flex-col gap-4"><div class="h-40 skeleton-line rounded-lg"></div><div class="flex-1 space-y-2"><div class="skeleton-line w-3/4"></div><div class="skeleton-line w-1/2"></div><div class="skeleton-line w-full"></div></div></div></div>
            </div>
            <div id="feed-container" class="hidden grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            <div id="toc-view" class="hidden card p-6"></div>
            <div id="load-more-container" class="text-center mt-8"></div>
            <div id="empty-state" class="text-center py-12 hidden">
                <p class="text-lg text-muted" id="empty-state-message">No entries yet. Check back soon!</p>
            </div>
        </section>
        
        <nav class="mt-12" aria-label="Quick links">
            <h2 class="text-3xl font-semibold mb-6 text-center brand-font text-gradient">Quick Links</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto">
                <a href="https://www.patreon.com/kimberlynfoster" class="card p-6 flex items-center gap-4 hover:!scale-105" rel="noopener noreferrer" target="_blank">
                    <div class="p-3 rounded-full bg-violet-500/20"><svg class="w-6 h-6 text-violet-300"  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg></div>
                    <span class="font-medium">Support on Patreon</span>
                </a>
                <a href="sms-optin.html" class="card p-6 flex items-center gap-4 hover:!scale-105">
                     <div class="p-3 rounded-full bg-violet-500/20"><svg class="w-6 h-6 text-violet-300"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round">  <path d="M15.2 3a2 2 0 0 1 2.8 2.8l-4.1 4.1 2.5 2.5 4.1-4.1a2 2 0 0 1 2.8 2.8l-10 10-4.5 1.5 1.5-4.5 10-10z" /></svg></div>
                    <span class="font-medium">Get Text Alerts</span>
                </a>
                <a href="https://kimberlynfoster.substack.com" class="card p-6 flex items-center gap-4 hover:!scale-105" rel="noopener noreferrer" target="_blank">
                    <div class="p-3 rounded-full bg-violet-500/20"><svg class="w-6 h-6 text-violet-300"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round">  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />  <polyline points="22,6 12,13 2,6" /></svg></div>
                    <span class="font-medium">Newsletter</span>
                </a>
            </div>
        </nav>
    </main>

    <footer class="text-center py-8 mt-12 text-sm text-muted" role="contentinfo">
        <div class="flex justify-center gap-2 mb-4">
            <button id="admin-signin-btn" class="btn btn-secondary !bg-transparent !text-sm !p-2" title="Admin sign in" aria-label="Admin sign in">
                <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16"><path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14l1.5 1.5L14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>
            </button>
            <button id="admin-signout-btn" class="btn btn-secondary !bg-transparent !text-sm !p-2 hidden" title="Admin sign out" aria-label="Admin sign out">
                 <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
            </button>
        </div>
        <p>&copy; 2025 Kimberly's Creative Sprint. All rights reserved.</p>
    </footer>

    <div id="welcome-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden flex items-center justify-center p-4 z-50 welcome-modal" role="dialog" aria-labelledby="welcome-modal-title" aria-modal="true">
        <div class="card p-8 relative max-w-2xl w-full">
            <button id="close-welcome-modal" class="absolute top-4 right-4 text-muted hover:text-primary transition-colors" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            <h2 id="welcome-modal-title" class="font-semibold mb-6 brand-font text-gradient text-center">What is the Creative Sprint?</h2>
            <div class="space-y-4 text-lg text-text-secondary">
              <p>For the next 90 days, I’m throwing myself into an experiment in making. The Creative Sprint isn’t about perfection or polish—it’s about rhythm and rigor. Each week I'll take on a theme—pop culture, politics, or the messy intersections of gender, race, capitalism, and art—and build a body of work around it. Videos, essays, livestreams, podcasts, posts—each orbiting the same core questions, each in conversation with the others.</p>
              <p>You’ll be able to trace the references, inspirations, and footnotes in real time. Not just what I think—but <em>how</em> I think.</p>
              <p class="text-xl font-semibold text-gradient my-6 italic text-center mx-auto">This is practice, but also proof: ambitious ideas deserve ambitious output.</p>
              <p>By the end of 90 days, I'll have more than a stack of work: I’ll have a living archive—a record of the thinkers, artists, and texts I’ve been in dialogue with, and a map of where my ideas might go next.</p>
              <p>This isn’t about chasing an algorithm. This is about giving creativity structure and space to breathe—and seeing what happens.</p>
              <p>The Sprint is an invitation: to run toward the work instead of away from it.</p>
            </div>
            <img src="https://knfoster13.github.io/HQ/KNFSIGNATURE.png" alt="Kimberly's signature" class="mx-auto mt-8 w-48" loading="lazy">
        </div>
    </div>

    <div id="subscribe-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden flex items-center justify-center p-4 z-50" role="dialog" aria-labelledby="subscribe-modal-title" aria-modal="true">
        <div class="card p-6 relative max-w-lg w-full">
            <button id="close-subscribe" class="absolute top-4 right-4 text-muted hover:text-primary transition-colors" aria-label="Close modal"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            <h2 id="subscribe-modal-title" class="font-semibold mb-4 text-center brand-font text-gradient">Join the Newsletter!</h2>
            <p class="text-muted mb-6 text-center mx-auto">Get exclusive updates, behind-the-scenes content, and early access to entries straight to your inbox!</p>
            <div class="bg-white rounded-xl p-1"><iframe src="https://kimberlynfoster.substack.com/embed" width="100%" height="320" style="border:1px solid #EEE; background:white;" frameborder="0" scrolling="no" title="Subscribe to newsletter"></iframe></div>
        </div>
    </div>
    
    <div id="toast" class="toast" role="alert" aria-live="polite">
        <svg id="toast-icon" class="w-5 h-5 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        <span id="toast-message">Action completed successfully!</span>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged, signOut, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, where, orderBy, doc, deleteDoc, updateDoc, increment, serverTimestamp, getDocs, writeBatch } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyDTd4lvs1lzjKeGu7Ee91lM30-8v88h-ng",
            authDomain: "productivity-tracker-knf13.firebaseapp.com",
            projectId: "productivity-tracker-knf13",
            storageBucket: "productivity-tracker-knf13.appspot.com",
            messagingSenderId: "762035393571",
            appId: "1:762035393571:web:7d474a6a57cc031b860d96"
        };
        const ADMIN_EMAIL = "submissions@forharriet.com";
        const START_DATE = new Date('2025-10-05T00:00:00');
        const END_DATE = new Date('2026-01-02T23:59:59');
        const MS_PER_DAY = 1000 * 60 * 60 * 24;
        const TOTAL_DAYS = 90;
        const ENTRIES_PER_PAGE = 9;
        const entriesCollectionPath = `artifacts/${firebaseConfig.projectId}/public/data/drops`;
        
        // --- UTILITY FUNCTIONS ---
        const getCurrentDay = () => {
            const now = new Date();
            if (now < START_DATE) return 0;
            if (now > END_DATE) return TOTAL_DAYS;
            const startOfDay = d => { const date = new Date(d); date.setHours(0,0,0,0); return date; };
            return Math.floor((startOfDay(now) - startOfDay(START_DATE)) / MS_PER_DAY) + 1;
        };
        const escapeHtml = str => str ? new DOMParser().parseFromString(str, 'text/html').body.textContent : '';
        const debounce = (func, wait) => {
            let timeout;
            return (...args) => { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), wait); };
        };
        const toJsDate = v => v?.toDate ? v.toDate() : (v ? new Date(v) : new Date());

        let db, auth, currentUser = null, isAdmin = false;
        
        const state = {
            allEntries: [],
            filteredEntries: [],
            currentFilter: 'all',
            currentSort: 'newest',
            currentView: 'grid',
            searchQuery: '',
            heartedPosts: JSON.parse(localStorage.getItem('heartedPosts') || '{}'),
            editingEntryId: null,
            unsubscribeEntries: null,
            visibleEntries: ENTRIES_PER_PAGE
        };

        const DOMElements = {};
        const elementIds = [
            'header-day', 'header-entries', 'header-streak', 'today-count', 'streak-count', 
            'free-count', 'paid-count', 'challenge-dates', 'admin-panel', 'admin-signin-btn', 'admin-signout-btn', 
            'search-input', 'sort-select', 'content-feed', 'empty-state', 'empty-state-message', 'subscribe-btn', 
            'hero-subscribe-btn', 'subscribe-modal', 'close-subscribe', 'toast', 'toast-message', 'toast-icon', 
            'weekly-theme', 'welcome-modal', 'show-welcome-btn', 'close-welcome-modal', 'spark-form', 'publish-btn', 
            'publish-btn-text', 'cancel-edit-btn', 'feed-container', 'skeleton-loaders', 'load-more-container',
            'chapter-markers', 'view-toggle-grid', 'view-toggle-toc', 'toc-view', 'header-progress-bar',
        ];
        
        const weeklyThemes = [
            "Narrative & Myth", "Digital Selves & Authenticity", "The Aesthetics of Power",
            "Creator Economy & The Future of Work", "Black Feminist Thought in a Digital Age", "Nostalgia, Trends, and the Cultural Cycle",
            "Visual Storytelling & Online Identity", "The Art of the Critique", "Building Community in Public",
            "Rest, Leisure, and Liberatory Practice", "Money, Ambition, and Creative Integrity", "The Algorithm & The Archive",
            "Reflections & Future Forecasts"
        ];
        
        const updateChapterMarkers = () => {
            if(!DOMElements.chapterMarkers) return;
            DOMElements.chapterMarkers.innerHTML = '';
            const currentDay = getCurrentDay();
            const weekNumber = Math.floor((currentDay - 1) / 7);
            
            const theme = weeklyThemes[weekNumber];
            if(theme){
                 const marker = document.createElement('div');
                marker.className = `card p-4 text-center`;
                marker.innerHTML = `
                    <span class="block uppercase tracking-widest text-sm text-accent">Chapter ${weekNumber+1}</span>
                    <span class="block mt-1 text-2xl brand-font">${theme} (Days ${weekNumber*7+1}-${weekNumber*7+7})</span>
                `;
                DOMElements.chapterMarkers.appendChild(marker);
            }
        };

        let toastTimeout;
        const showToast = (message, type = 'success') => {
            clearTimeout(toastTimeout);
            // Toast implementation here
        };
        
        const resetForm = () => {
            DOMElements.sparkForm?.reset();
            state.editingEntryId = null;
            if(DOMElements.publishBtnText) DOMElements.publishBtnText.textContent = 'Publish Entry';
            DOMElements.cancelEditBtn?.classList.add('hidden');
        };

        const populateFormForEdit = (entry) => {
            state.editingEntryId = entry.id;
            document.getElementById('spark-title').value = entry.title || '';
            document.getElementById('spark-description').value = entry.description || '';
            document.getElementById('spark-link').value = entry.link || '';
            document.getElementById('spark-image').value = entry.imageUrl || '';
            document.getElementById('spark-type').value = entry.contentType || 'Video';
            document.getElementById('spark-access').value = entry.access || 'Free';
            document.getElementById('spark-footnotes').value = entry.footnotes || '';
            DOMElements.publishBtnText.textContent = 'Update Entry';
            DOMElements.cancelEditBtn.classList.remove('hidden');
            window.scrollTo({ top: DOMElements.adminPanel.offsetTop - 80, behavior: 'smooth' });
        };

        const checkFormValidity = () => {
            if (!DOMElements.sparkForm) return;
            const isValidLink = (link) => { try { new URL(link); return true; } catch { return false; }};
            const title = document.getElementById('spark-title').value.trim();
            const desc = document.getElementById('spark-description').value.trim();
            const link = document.getElementById('spark-link').value.trim();
            DOMElements.publishBtn.disabled = !(title && desc && isValidLink(link));
        };
        
        const createEntryCard = (entry, scrollObserver) => {
            const isHearted = state.heartedPosts[entry.id];
            const entryDate = toJsDate(entry.timestamp);
            
            const fallbackImage = `https://placehold.co/400x300/973f8e/efeaf7?text=${encodeURIComponent(entry.contentType)}`;
            const imageUrl = entry.imageUrl || fallbackImage;

            const adminButtons = isAdmin ? `
                <button class="edit-btn text-muted hover:text-accent" data-id="${entry.id}"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L16.732 3.732z"></path></svg></button>
                <button class="delete-btn text-muted hover:text-error" data-id="${entry.id}"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
            ` : '';

            const card = document.createElement('div');
            card.className = 'card flex flex-col';
            card.dataset.id = entry.id;
            
            card.innerHTML = `
                <div class="p-5 flex-grow flex flex-col">
                     <div class="flex items-start justify-between">
                        <span class="tag ${entry.access === 'Paid' ? 'tag-paid' : 'tag-free'}">${entry.access}</span>
                        <div class="monospace text-xs text-muted">Entry №${entry.day}</div>
                    </div>
                    <h3 class="mt-3 font-semibold text-accent-light hover:text-white transition-colors text-xl">
                        <a href="${escapeHtml(entry.link)}" target="_blank" rel="noopener noreferrer">${escapeHtml(entry.title)}</a>
                    </h3>
                    <p class="text-sm mt-1 line-clamp-3 flex-grow">${escapeHtml(entry.description)}</p>
                     <div class="mt-4 pt-3 border-t border-[color:var(--border-color)]">
                        <div class="flex items-center gap-4">
                           <button class="heart-btn flex items-center gap-1.5 text-sm ${isHearted ? 'text-heart hearted' : 'text-muted hover:text-heart'}" data-id="${entry.id}">
                            <svg class="w-5 h-5" fill="${isHearted ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.25l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.5l-1.318-1.182a4.5 4.5 0 00-6.364 0z"></path></svg>
                            <span class="font-mono">${entry.hearts || 0}</span>
                        </button>
                        ${entry.footnotes ? `<button class="marginalia-toggle" data-id="${entry.id}">Marginalia</button>` : ''}
                        <div class="ml-auto flex items-center gap-3">${adminButtons}</div>
                        </div>
                         ${entry.footnotes ? `<div class="marginalia mt-3" id="marginalia-${entry.id}">${escapeHtml(entry.footnotes).replace(/\n/g, '<br>')}</div>` : ''}
                    </div>
                </div>
            `;
            if (scrollObserver) scrollObserver.observe(card);
            return card;
        };

        const renderEntries = (scrollObserver) => {
            DOMElements.skeletonLoaders.classList.add('hidden');
            DOMElements.contentFeed.setAttribute('aria-busy', 'false');

            const published = state.allEntries.filter(d => d.status === 'published');
            
            DOMElements.headerEntries.textContent = published.length;
            DOMElements.todayCount.textContent = published.filter(s => s.day === getCurrentDay()).length;
            DOMElements.freeCount.textContent = published.filter(s => s.access === 'Free').length;
            DOMElements.paidCount.textContent = published.filter(s => s.access === 'Paid').length;
            DOMElements.streakCount.textContent = new Set(published.map(s => s.day)).size;
            DOMElements.headerStreak.textContent = new Set(published.map(s => s.day)).size;

            DOMElements.feedContainer.innerHTML = '';
            DOMElements.tocView.innerHTML = '';

            if (state.filteredEntries.length > 0) {
                // Grid View
                const grid = document.createElement('div');
                grid.className = 'grid sm:grid-cols-2 lg:grid-cols-3 gap-6';
                state.filteredEntries.slice(0, state.visibleEntries).forEach(entry => {
                    grid.appendChild(createEntryCard(entry, scrollObserver));
                });
                DOMElements.feedContainer.appendChild(grid);
                
                // TOC View
                const tocList = document.createElement('ul');
                tocList.className = 'space-y-4';
                state.filteredEntries.forEach(entry => {
                    const li = document.createElement('li');
                    li.className = 'border-b border-[color:var(--border-color)] pb-2';
                    li.innerHTML = `<a href="${entry.link}" target="_blank" rel="noopener" class="hover:text-accent-light transition-colors"><strong class="font-normal">Entry №${entry.day}:</strong> ${escapeHtml(entry.title)}</a>`;
                    tocList.appendChild(li);
                });
                DOMElements.tocView.appendChild(tocList);

                DOMElements.loadMoreContainer.innerHTML = '';
                if (state.filteredEntries.length > state.visibleEntries) {
                    const loadMoreBtn = document.createElement('button');
                    loadMoreBtn.textContent = 'Previous Entries →';
                    loadMoreBtn.className = 'btn btn-secondary mx-auto mt-8';
                    loadMoreBtn.onclick = () => {
                        state.visibleEntries += ENTRIES_PER_PAGE;
                        renderEntries(scrollObserver);
                    };
                    DOMElements.loadMoreContainer.appendChild(loadMoreBtn);
                }
                DOMElements.emptyState?.classList.add('hidden');
            } else {
                 DOMElements.emptyState?.classList.remove('hidden');
                 DOMElements.emptyStateMessage.textContent = (state.searchQuery) ? 'No entries found matching your criteria.' : 'No entries yet.';
            }
        };
        
        const applyFiltersAndSort = (scrollObserver) => {
            state.visibleEntries = ENTRIES_PER_PAGE;
            const published = state.allEntries.filter(d => d.status === 'published');
            state.filteredEntries = published.filter(entry => {
                const search = state.searchQuery.toLowerCase();
                return !search || entry.title.toLowerCase().includes(search) || entry.description.toLowerCase().includes(search);
            });
            
            state.filteredEntries.sort((a, b) => {
                const timeA = a.timestamp?.toMillis() || 0;
                const timeB = b.timestamp?.toMillis() || 0;
                switch (state.currentSort) {
                    case 'oldest': return timeA - timeB;
                    case 'most-loved': return (b.hearts || 0) - (a.hearts || 0);
                    default: return timeB - timeA;
                }
            });
            renderEntries(scrollObserver);
        };
        
        const handleContentClick = async (e) => {
            const btn = e.target.closest('button');
            if (!btn) return;
            
            const card = btn.closest('.card');
            const id = card?.dataset.id;
            
            if(btn.classList.contains('marginalia-toggle')) {
                const marginalia = document.getElementById(`marginalia-${id}`);
                marginalia?.classList.toggle('show');
                return;
            }

            if (!id) return;

            if (btn.classList.contains('delete-btn')) {
                 if (window.confirm('Delete this entry? This cannot be undone.')) {
                    await deleteDoc(doc(db, entriesCollectionPath, id));
                }
            } else if (btn.classList.contains('edit-btn')) {
                populateFormForEdit(state.allEntries.find(d => d.id === id));
            } else if (btn.classList.contains('heart-btn')) {
                if (state.heartedPosts[id]) return;
                state.heartedPosts[id] = true;
                localStorage.setItem('heartedPosts', JSON.stringify(state.heartedPosts));
                await updateDoc(doc(db, entriesCollectionPath, id), { hearts: increment(1) });
            }
        };

        const updateProgress = () => {
            const day = getCurrentDay();
            const progress = Math.min(100, (day / TOTAL_DAYS) * 100);
            if (DOMElements.headerDay) DOMElements.headerDay.textContent = day;
            if (DOMElements.headerProgressBar) {
                const fill = DOMElements.headerProgressBar.querySelector('.header-progress-fill');
                if (fill) fill.style.width = `${progress}%`;
                DOMElements.headerProgressBar.setAttribute('aria-valuenow', day);
            }
        };
        
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp(firebaseConfig);
            auth = getAuth();
            db = getFirestore();

             elementIds.forEach(id => {
                DOMElements[id.replace(/-(\w)/g, (m, g) => g.toUpperCase())] = document.getElementById(id);
            });

            const scrollObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('is-visible'); });
            }, { threshold: 0.1 });

            document.querySelectorAll('main .card, .fade-in-section').forEach(el => scrollObserver.observe(el));

            onAuthStateChanged(auth, async (user) => {
                currentUser = user;
                isAdmin = user?.email === ADMIN_EMAIL;
                
                document.body.classList.toggle('is-admin', isAdmin);
                if(DOMElements.adminPanel) DOMElements.adminPanel.classList.toggle('hidden', !isAdmin);
                if(DOMElements.adminSigninBtn) DOMElements.adminSigninBtn.classList.toggle('hidden', isAdmin);
                if(DOMElements.adminSignoutBtn) DOMElements.adminSignoutBtn.classList.toggle('hidden', !isAdmin);

                if (!user) await signInAnonymously(auth);
                
                if (state.unsubscribeEntries) state.unsubscribeEntries();
                const q = query(collection(db, entriesCollectionPath), orderBy('timestamp', 'desc'));
                state.unsubscribeEntries = onSnapshot(q, (snapshot) => {
                    state.allEntries = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    applyFiltersAndSort(scrollObserver);
                });
            });

            if(DOMElements.challengeDates) DOMElements.challengeDates.innerHTML = `${START_DATE.toLocaleDateString('en-US', { month: 'long', day: 'numeric' })} &mdash; ${END_DATE.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
            
            updateProgress();
            updateChapterMarkers();
            
            setInterval(updateProgress, 60000);

            const setupModal = (modal, openBtns, closeBtn) => {
                openBtns.forEach(btn => btn?.addEventListener('click', () => {modal?.classList.remove('hidden'); modal?.classList.add('flex')}));
                closeBtn?.addEventListener('click', () => {modal?.classList.add('hidden'); modal?.classList.remove('flex')});
                modal?.addEventListener('click', (e) => {
                    if (e.target === modal) {modal.classList.add('hidden'); modal.classList.remove('flex')}
                });
            };
            
            setupModal(DOMElements.welcomeModal, [DOMElements.showWelcomeBtn], DOMElements.closeWelcomeModal);
            setupModal(DOMElements.subscribeModal, [DOMElements.subscribeBtn, DOMElements.heroSubscribeBtn], DOMElements.closeSubscribe);

            DOMElements.sparkForm?.addEventListener('input', checkFormValidity);
            DOMElements.sparkForm?.addEventListener('submit', async (e) => {
                e.preventDefault();
                const formData = {
                    title: document.getElementById('spark-title').value,
                    description: document.getElementById('spark-description').value,
                    link: document.getElementById('spark-link').value,
                    imageUrl: document.getElementById('spark-image').value,
                    contentType: document.getElementById('spark-type').value,
                    access: document.getElementById('spark-access').value,
                    footnotes: document.getElementById('spark-footnotes').value,
                    status: 'published',
                    day: getCurrentDay(),
                    timestamp: serverTimestamp(),
                };
                if(state.editingEntryId) {
                    await updateDoc(doc(db, entriesCollectionPath, state.editingEntryId), formData);
                } else {
                    formData.hearts = 0;
                    await addDoc(collection(db, entriesCollectionPath), formData);
                }
                resetForm();
            });
            if(DOMElements.contentFeed) DOMElements.contentFeed.addEventListener('click', handleContentClick);
            DOMElements.searchInput?.addEventListener('input', debounce(() => { state.searchQuery = DOMElements.searchInput.value; applyFiltersAndSort(scrollObserver); }, 300));
            DOMElements.sortSelect?.addEventListener('change', (e) => { state.currentSort = e.target.value; applyFiltersAndSort(scrollObserver); });
            DOMElements.adminSigninBtn?.addEventListener('click', () => signInWithPopup(auth, new GoogleAuthProvider()));
            DOMElements.adminSignoutBtn?.addEventListener('click', () => signOut(auth));
            DOMElements.cancelEditBtn?.addEventListener('click', resetForm);

            DOMElements.viewToggleGrid.addEventListener('click', () => {
                state.currentView = 'grid';
                DOMElements.viewToggleGrid.classList.add('active');
                DOMElements.viewToggleToc.classList.remove('active');
                DOMElements.contentFeed.classList.remove('hidden');
                DOMElements.tocView.classList.remove('active');
            });
            DOMElements.viewToggleToc.addEventListener('click', () => {
                state.currentView = 'toc';
                DOMElements.viewToggleGrid.classList.remove('active');
                DOMElements.viewToggleToc.classList.add('active');
                DOMElements.contentFeed.classList.add('hidden');
                DOMElements.tocView.classList.add('active');
            });

        });
    </script>
</body>
</html>

